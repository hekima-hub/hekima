<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.8, maximum-scale=1.0, user-scalable=no">
    <title>Hekima Hub - Expand Your Knowledge</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2E8B57;
            --secondary: #4169E1;
            --accent: #800000;
            --highlight: #FFD700;
            --dark: #1c1d1f;
            --light: #f7f9fa;
            --gray: #6a6f73;
            --success: #1e6055;
            --white: #ffffff;
            --vpay-navy: #001f3f;
            --vpay-navy-light: #003366;
            --error: #dc3545;
            --warning: #ffc107;
        }

        /* V-PAY Integration Styles */
        .vpay-payment-option {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .vpay-payment-option:hover {
            border-color: var(--primary);
            background: white;
        }

        .vpay-payment-option.active {
            border-color: var(--primary);
            background: #e8f5e8;
        }

        .vpay-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .vpay-features {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
        }

        .vpay-features ul {
            list-style: none;
            padding-left: 0;
        }

        .vpay-features li {
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .vpay-features i {
            color: var(--primary);
            font-size: 0.8rem;
        }

        .vpay-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .vpay-modal-content {
            background: white;
            border-radius: 12px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .vpay-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
            z-index: 10;
        }

        .vpay-header {
            background: linear-gradient(135deg, var(--vpay-navy) 0%, var(--vpay-navy-light) 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            border-radius: 12px 12px 0 0;
        }

        .vpay-header h3 {
            margin-bottom: 0.5rem;
            font-size: 1.5rem;
        }

        .vpay-body {
            padding: 2rem;
        }

        .vpay-step {
            display: none;
        }

        .vpay-step.active {
            display: block;
        }

        .vpay-business-info {
            background: #e7f3ff;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--vpay-navy);
        }

        .vpay-amount-input {
            text-align: center;
            margin: 1.5rem 0;
        }

        .vpay-amount-input input {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            padding: 1rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            width: 100%;
            max-width: 200px;
            margin: 0 auto;
            display: block;
        }

        .vpay-payment-methods {
            margin: 1.5rem 0;
        }

        .vpay-method-card {
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .vpay-method-card.active {
            border-color: var(--vpay-navy);
            background: #f8f9fa;
        }

        .vpay-method-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 0.5rem;
        }

        .vpay-method-icon {
            font-size: 1.2rem;
            color: var(--vpay-navy);
        }

        .vpay-method-name {
            font-weight: 600;
            color: var(--vpay-navy);
        }

        .vpay-details-card {
            background: var(--vpay-navy);
            color: white;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .vpay-details-text {
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .vpay-copy-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .vpay-copy-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .vpay-summary {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .vpay-summary-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #ddd;
        }

        .vpay-summary-item:last-child {
            border-bottom: none;
        }

        .vpay-steps {
            display: flex;
            justify-content: space-between;
            margin: 1.5rem 0;
            position: relative;
        }

        .vpay-steps::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 2px;
            background: #ddd;
            z-index: 1;
        }

        .vpay-step-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .vpay-step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #ddd;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }

        .vpay-step-indicator.active .vpay-step-number {
            background: var(--vpay-navy);
        }

        .vpay-step-indicator.completed .vpay-step-number {
            background: var(--primary);
        }

        .vpay-step-label {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--gray);
            text-align: center;
        }

        .vpay-step-indicator.active .vpay-step-label {
            color: var(--vpay-navy);
        }

        .vpay-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .vpay-btn {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .vpay-btn-primary {
            background: var(--vpay-navy);
            color: white;
        }

        .vpay-btn-primary:hover {
            background: var(--vpay-navy-light);
        }

        .vpay-btn-secondary {
            background: #6c757d;
            color: white;
        }

        .vpay-btn-secondary:hover {
            background: #5a6268;
        }

        .vpay-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .vpay-loading {
            text-align: center;
            padding: 2rem;
            display: none;
        }

        .vpay-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--vpay-navy);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .vpay-success {
            text-align: center;
            padding: 2rem;
        }

        .vpay-success-icon {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .vpay-error {
            text-align: center;
            padding: 2rem;
            display: none;
        }

        .vpay-error-icon {
            font-size: 4rem;
            color: var(--error);
            margin-bottom: 1rem;
        }

        .vpay-receipt {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            text-align: left;
        }

        .vpay-receipt h4 {
            color: var(--vpay-navy);
            margin-bottom: 1rem;
            text-align: center;
        }

        .vpay-receipt-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #ddd;
        }

        .vpay-receipt-item:last-child {
            border-bottom: none;
        }

        .vpay-receipt-label {
            font-weight: 600;
            color: var(--dark);
        }

        .vpay-receipt-value {
            color: var(--gray);
        }

        .vpay-offline-notice {
            background: var(--warning);
            color: #856404;
            padding: 0.75rem;
            border-radius: 6px;
            margin: 1rem 0;
            text-align: center;
            font-size: 0.9rem;
        }

        /* Loading States */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Auth Modal Styles */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .auth-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            padding: 2rem;
            position: relative;
            text-align: center;
        }

        .google-signin-btn {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            color: var(--dark);
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            min-height: 44px;
        }

        .google-signin-btn:hover {
            background: #f8f9fa;
            border-color: #ccc;
        }

        .google-signin-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .auth-footer {
            margin-top: 1.5rem;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .auth-footer a {
            color: var(--primary);
            text-decoration: none;
        }

        /* Simplified User Menu Styles */
        .user-menu {
            display: none;
            align-items: center;
            gap: 0.5rem;
            position: relative;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .user-avatar:hover {
            transform: scale(1.05);
        }

        .user-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 1rem;
            min-width: 200px;
            z-index: 1000;
            margin-top: 0.5rem;
        }

        .user-dropdown.active {
            display: block;
        }

        .user-dropdown-info {
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #eee;
            margin-bottom: 0.75rem;
        }

        .user-dropdown-name {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.25rem;
        }

        .user-dropdown-email {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .logout-btn {
            background: none;
            border: 1px solid var(--accent);
            color: var(--accent);
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            width: 100%;
        }

        .logout-btn:hover {
            background: var(--accent);
            color: white;
        }

        body {
            background-color: var(--white);
            color: var(--dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        header {
            background-color: var(--white);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .logo-img {
            height: 40px;
            width: auto;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            margin-left: 2rem;
        }

        .nav-links a {
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .nav-links a.active {
            color: var(--primary);
            font-weight: 600;
        }

        .nav-links a.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary);
        }

        .search-bar {
            flex: 1;
            max-width: 600px;
            margin: 0 2rem;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 20px;
            border: 1px solid #ddd;
            border-radius: 30px;
            font-size: 1rem;
        }

        .search-bar button {
            position: absolute;
            right: 5px;
            top: 5px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 7px 15px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .search-bar button:hover {
            background: var(--secondary);
        }

        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 10;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }

        .search-suggestion {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            transition: background 0.2s ease;
        }

        .search-suggestion:hover {
            background: var(--light);
        }

        .search-suggestion:last-child {
            border-bottom: none;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: nowrap;
        }

        .header-actions a {
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
        }

        .cart, .auth-buttons {
            display: flex;
            gap: 1rem;
        }

        .cart-icon {
            position: relative;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--accent);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-outline {
            border: 1px solid var(--dark);
            background: transparent;
            color: var(--dark);
        }

        .btn-outline:hover {
            background: var(--light);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            background: var(--secondary);
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--primary);
        }

        /* Mobile Menu */
        .mobile-menu {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 1000;
            padding: 2rem;
            flex-direction: column;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .mobile-menu.active {
            transform: translateX(0);
        }

        .mobile-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .mobile-nav-links {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .mobile-nav-links a {
            color: var(--dark);
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }

        .mobile-nav-links a.active {
            color: var(--primary);
            font-weight: 600;
        }

        .close-menu {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--dark);
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 4rem 2rem;
            text-align: center;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .hero-search {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .hero-search input {
            width: 100%;
            padding: 15px 20px;
            border: none;
            border-radius: 30px;
            font-size: 1rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* Categories */
        .categories {
            padding: 3rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .section-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            position: relative;
            display: inline-block;
        }

        .section-title:after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 4px;
            background: var(--highlight);
            border-radius: 2px;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .category-card {
            background: var(--light);
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .category-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        /* Featured Courses */
        .featured-courses {
            padding: 3rem 2rem;
            background: var(--light);
        }

        .courses-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .courses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }

        .course-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .course-card:hover {
            transform: translateY(-5px);
        }

        .course-image {
            height: 180px;
            position: relative;
            background-size: cover;
            background-position: center;
        }

        .course-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .course-content {
            padding: 1.5rem;
        }

        .course-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        .course-duration {
            color: var(--gray);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .course-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 1rem;
        }

        .rating-stars {
            color: var(--highlight);
        }

        .rating-count {
            color: var(--gray);
            font-size: 0.9rem;
        }

        .course-price {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .current-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
        }

        .original-price {
            color: var(--gray);
            text-decoration: line-through;
        }

        .bestseller {
            background: var(--highlight);
            color: #593d00;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Course Detail Modal */
        .course-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }

        .course-detail {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .close-course {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
            z-index: 10;
            background: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .course-detail-header {
            height: 300px;
            background-size: cover;
            background-position: center;
            position: relative;
            border-radius: 8px 8px 0 0;
        }

        .course-detail-content {
            padding: 2rem;
        }

        .course-detail-title {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .course-detail-meta {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--gray);
        }

        .course-detail-description {
            margin-bottom: 2rem;
            line-height: 1.7;
        }

        .course-detail-objectives {
            margin-bottom: 2rem;
        }

        .course-detail-objectives h3 {
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .course-detail-objectives ul {
            padding-left: 1.5rem;
        }

        .course-detail-objectives li {
            margin-bottom: 0.5rem;
        }

        .course-detail-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .course-detail-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Why Choose Us */
        .why-choose {
            padding: 4rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .feature {
            text-align: center;
            padding: 2rem 1rem;
            border-radius: 8px;
            background: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
        }

        .feature:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .feature h3 {
            margin-bottom: 1rem;
            font-size: 1.3rem;
            color: var(--dark);
        }

        /* Video Feature */
        .video-feature {
            grid-column: 1 / -1;
            text-align: center;
            padding: 2rem;
            border-radius: 8px;
            background: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
        }

        .video-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .video-container iframe {
            width: 100%;
            height: 450px;
            border: none;
        }

        /* Cart Modal */
        .cart-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .cart-content {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 2rem;
            position: relative;
        }

        .close-cart {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        .cart-items {
            margin: 1.5rem 0;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-info h4 {
            margin-bottom: 5px;
        }

        .cart-item-price {
            font-weight: 600;
            color: var(--primary);
        }

        .remove-item {
            background: none;
            border: none;
            color: var(--accent);
            cursor: pointer;
            font-size: 1.2rem;
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 1.2rem;
            font-weight: 700;
            margin: 1.5rem 0;
            padding-top: 1rem;
            border-top: 2px solid #eee;
        }

        /* Checkout Form */
        .checkout-form {
            margin-top: 2rem;
            text-align: center;
        }

        .btn-whatsapp {
            background: #25D366;
            color: white;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
            width: 100%;
            justify-content: center;
            margin-top: 1rem;
        }

        .btn-whatsapp:hover {
            background: #128C7E;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            padding: 12px 20px;
            border-radius: 5px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            z-index: 1001;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast-success {
            background: var(--primary);
        }

        .toast-error {
            background: var(--error);
        }

        .toast-warning {
            background: var(--warning);
            color: var(--dark);
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            padding: 3rem 2rem 1rem;
        }

        .footer-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }

        .footer-logo {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .footer-links h4 {
            margin-bottom: 1rem;
            font-size: 1.1rem;
            color: var(--highlight);
        }

        .footer-links ul {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: #ddd;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--highlight);
            text-decoration: underline;
        }

        .copyright {
            text-align: center;
            margin-top: 3rem;
            padding-top: 1rem;
            border-top: 1px solid #444;
            color: #aaa;
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            .header-container {
                padding: 1rem;
            }

            .nav-links {
                display: none;
            }

            .search-bar {
                display: none;
            }

            .header-actions .auth-buttons {
                display: none;
            }

            .menu-toggle {
                display: block;
            }

            .mobile-menu {
                display: flex;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .categories-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .courses-grid {
                grid-template-columns: 1fr;
            }

            .featured-courses, .categories, .why-choose {
                padding: 2rem 1rem;
            }

            .course-detail-actions {
                flex-direction: column;
                align-items: stretch;
            }

            .course-detail-actions .btn {
                width: 100%;
            }

            .user-avatar {
                width: 36px;
                height: 36px;
            }

            .video-container iframe {
                height: 250px;
            }
        }

        @media (max-width: 480px) {
            .hero {
                padding: 2rem 1rem;
            }

            .categories-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .features-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <a href="#" class="logo">
                <img src="https://i.postimg.cc/zv1G6fvB/Whats-App-Image-2025-11-18-at-16-22-32-removebg-preview.webp" alt="Hekima Hub Logo" class="logo-img">
                <span>Hekima Hub</span>
            </a>
            
            <nav class="nav-links">
                <a href="#" class="active">Home</a>
                <a href="courses.html">Courses</a>
                <a href="categories.html">Categories</a>
                <a href="#">Instructors</a>
                <a href="#">About</a>
            </nav>
            
            <div class="search-bar">
                <input type="text" placeholder="Search for anything" id="search-input">
                <button id="search-button"><i class="fas fa-search"></i></button>
                <div class="search-suggestions" id="search-suggestions">
                    <!-- Search suggestions will be populated here -->
                </div>
            </div>
            
            <div class="header-actions">
                <div class="cart">
                    <a href="#" id="cart-icon" class="cart-icon">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count" id="cart-count">0</span>
                    </a>
                </div>
                
                <!-- Auth Buttons (shown when user is not logged in) -->
                <div class="auth-buttons" id="auth-buttons">
                    <button class="btn btn-primary" id="signin-btn">Sign In</button>
                </div>
                
                <!-- User Menu (shown when user is logged in) -->
                <div class="user-menu" id="user-menu">
                    <img src="" alt="User Avatar" class="user-avatar" id="user-avatar">
                    <div class="user-dropdown" id="user-dropdown">
                        <div class="user-dropdown-info">
                            <div class="user-dropdown-name" id="user-dropdown-name"></div>
                            <div class="user-dropdown-email" id="user-dropdown-email"></div>
                        </div>
                        <button class="logout-btn" id="logout-btn">Logout</button>
                    </div>
                </div>
                
                <button class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobile-menu">
        <div class="mobile-menu-header">
            <a href="#" class="logo">
                <img src="https://i.postimg.cc/zv1G6fvB/Whats-App-Image-2025-11-18-at-16-22-32-removebg-preview.webp" alt="Hekima Hub Logo" class="logo-img">
                <span>Hekima Hub</span>
            </a>
            <button class="close-menu" id="close-menu">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <nav class="mobile-nav-links">
            <a href="#" class="active">Home</a>
            <a href="courses.html">Courses</a>
            <a href="categories.html">Categories</a>
            <a href="#">Instructors</a>
            <a href="#">About</a>
            <a href="#" id="mobile-signin">Sign In</a>
        </nav>
    </div>

    <!-- Auth Modal -->
    <div class="auth-modal" id="auth-modal">
        <div class="auth-content">
            <h2 style="margin-bottom: 1.5rem;">Welcome to Hekima Hub</h2>
            
            <div id="google-signin-container">
                <div class="google-signin-btn" id="google-signin-btn">
                    <i class="fab fa-google"></i>
                    <span id="google-btn-text">Continue with Google</span>
                </div>
            </div>
            
            <div class="auth-footer">
                By signing in, you agree to our <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>
            </div>
        </div>
    </div>

    <!-- V-PAY Modal -->
    <div class="vpay-modal" id="vpay-modal">
        <div class="vpay-modal-content">
            <button class="vpay-close" id="vpay-close">&times;</button>
            <div class="vpay-header">
                <h3>Secure Payment with V-PAY</h3>
                <p>Complete your purchase safely and securely</p>
            </div>
            <div class="vpay-body">
                <div class="vpay-steps">
                    <div class="vpay-step-indicator active" id="vpay-step-1">
                        <div class="vpay-step-number">1</div>
                        <div class="vpay-step-label">Amount</div>
                    </div>
                    <div class="vpay-step-indicator" id="vpay-step-2">
                        <div class="vpay-step-number">2</div>
                        <div class="vpay-step-label">Payment</div>
                    </div>
                    <div class="vpay-step-indicator" id="vpay-step-3">
                        <div class="vpay-step-number">3</div>
                        <div class="vpay-step-label">Confirm</div>
                    </div>
                </div>

                <!-- Step 1: Amount -->
                <div class="vpay-step active" id="vpay-amount-step">
                    <div class="vpay-business-info">
                        <h4>Hekima Hub</h4>
                        <p>Complete your course purchase</p>
                    </div>
                    <div class="vpay-amount-input">
                        <input type="number" id="vpay-amount" placeholder="0" min="1" value="0" readonly>
                    </div>
                    <div style="text-align: center; color: var(--gray); margin-bottom: 1.5rem;">
                        Amount in Kenyan Shillings (KES)
                    </div>
                    <button class="vpay-btn vpay-btn-primary" id="vpay-continue-to-payment">
                        Continue to Payment <i class="fas fa-arrow-right"></i>
                    </button>
                </div>

                <!-- Step 2: Payment Method -->
                <div class="vpay-step" id="vpay-payment-step">
                    <div class="vpay-business-info">
                        <h4>Hekima Hub</h4>
                        <p>Choose your payment method</p>
                    </div>
                    <div class="vpay-payment-methods" id="vpay-methods-container">
                        <!-- Payment methods will be loaded here -->
                    </div>
                    <div class="vpay-buttons">
                        <button class="vpay-btn vpay-btn-secondary" id="vpay-back-to-amount">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="vpay-btn vpay-btn-primary" id="vpay-continue-to-confirm">
                            Continue <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 3: Confirmation -->
                <div class="vpay-step" id="vpay-confirm-step">
                    <div class="vpay-business-info">
                        <h4>Payment Summary</h4>
                    </div>
                    <div class="vpay-summary">
                        <div class="vpay-summary-item">
                            <span>Business:</span>
                            <span id="vpay-summary-business">Hekima Hub</span>
                        </div>
                        <div class="vpay-summary-item">
                            <span>Amount:</span>
                            <span id="vpay-summary-amount">KES 0</span>
                        </div>
                        <div class="vpay-summary-item">
                            <span>Payment Method:</span>
                            <span id="vpay-summary-method">-</span>
                        </div>
                    </div>
                    <div style="margin: 1.5rem 0;">
                        <label for="vpay-transaction-id" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                            Transaction Reference Number
                        </label>
                        <input type="text" id="vpay-transaction-id" placeholder="Enter M-PESA transaction code" 
                               style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px;">
                        <small style="color: var(--gray); margin-top: 0.5rem; display: block;">
                            Enter the code you received after making the payment
                        </small>
                    </div>
                    <div class="vpay-buttons">
                        <button class="vpay-btn vpay-btn-secondary" id="vpay-back-to-payment">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button class="vpay-btn vpay-btn-primary" id="vpay-submit-payment">
                            <i class="fas fa-paper-plane"></i> Submit Payment
                        </button>
                    </div>
                </div>

                <!-- Loading State -->
                <div class="vpay-loading" id="vpay-loading">
                    <div class="vpay-spinner"></div>
                    <div>Processing your payment...</div>
                </div>

                <!-- Success State -->
                <div class="vpay-success" id="vpay-success" style="display: none;">
                    <div class="vpay-success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>Payment Submitted Successfully!</h3>
                    <p id="vpay-success-message">Your payment has been processed and a receipt has been sent to your email.</p>
                    
                    <!-- Receipt Details -->
                    <div class="vpay-receipt" id="vpay-receipt">
                        <h4>Payment Receipt</h4>
                        <div class="vpay-receipt-item">
                            <span class="vpay-receipt-label">Receipt ID:</span>
                            <span class="vpay-receipt-value" id="receipt-id"></span>
                        </div>
                        <div class="vpay-receipt-item">
                            <span class="vpay-receipt-label">Business:</span>
                            <span class="vpay-receipt-value" id="receipt-business"></span>
                        </div>
                        <div class="vpay-receipt-item">
                            <span class="vpay-receipt-label">Amount:</span>
                            <span class="vpay-receipt-value" id="receipt-amount"></span>
                        </div>
                        <div class="vpay-receipt-item">
                            <span class="vpay-receipt-label">Payment Method:</span>
                            <span class="vpay-receipt-value" id="receipt-method"></span>
                        </div>
                        <div class="vpay-receipt-item">
                            <span class="vpay-receipt-label">Date:</span>
                            <span class="vpay-receipt-value" id="receipt-date"></span>
                        </div>
                        <div class="vpay-receipt-item">
                            <span class="vpay-receipt-label">Courses:</span>
                            <span class="vpay-receipt-value" id="receipt-courses"></span>
                        </div>
                    </div>
                    
                    <button class="vpay-btn vpay-btn-primary" id="vpay-success-close">
                        Continue Shopping
                    </button>
                </div>

                <!-- Error State -->
                <div class="vpay-error" id="vpay-error">
                    <div class="vpay-error-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h3>Payment Processing Failed</h3>
                    <p id="vpay-error-message">There was an error processing your payment. Please try again.</p>
                    <div class="vpay-offline-notice" id="vpay-offline-notice" style="display: none;">
                        <i class="fas fa-wifi"></i> You are currently offline. Your payment has been saved and will be processed when you're back online.
                    </div>
                    <div class="vpay-buttons">
                        <button class="vpay-btn vpay-btn-secondary" id="vpay-error-retry">
                            <i class="fas fa-redo"></i> Try Again
                        </button>
                        <button class="vpay-btn vpay-btn-primary" id="vpay-error-close">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Learning That Never Stops</h1>
            <p>Expand your knowledge with thousands of courses from expert instructors at Hekima Hub.</p>
            <div class="hero-search">
                <input type="text" placeholder="What do you want to learn today?" id="hero-search-input">
            </div>
        </div>
    </section>

    <!-- Categories -->
    <section class="categories">
        <h2 class="section-title">Explore Categories</h2>
        <div class="categories-grid">
            <div class="category-card">
                <div class="category-icon">
                    <i class="fas fa-laptop-code"></i>
                </div>
                <h3>Technology</h3>
            </div>
            <div class="category-card">
                <div class="category-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h3>Business</h3>
            </div>
            <div class="category-card">
                <div class="category-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <h3>Finance</h3>
            </div>
            <div class="category-card">
                <div class="category-icon">
                    <i class="fas fa-pencil-alt"></i>
                </div>
                <h3>Design</h3>
            </div>
            <div class="category-card">
                <div class="category-icon">
                    <i class="fas fa-music"></i>
                </div>
                <h3>Music</h3>
            </div>
            <div class="category-card">
                <div class="category-icon">
                    <i class="fas fa-camera"></i>
                </div>
                <h3>Photography</h3>
            </div>
            <div class="category-card">
                <div class="category-icon">
                    <i class="fas fa-heartbeat"></i>
                </div>
                <h3>Health</h3>
            </div>
            <div class="category-card">
                <div class="category-icon">
                    <i class="fas fa-language"></i>
                </div>
                <h3>Languages</h3>
            </div>
        </div>
    </section>

    <!-- Featured Courses -->
    <section class="featured-courses">
        <div class="courses-container">
            <h2 class="section-title">Featured Courses</h2>
            <div class="courses-grid">
                <div class="course-card" data-course="data-entry">
                    <div class="course-image" style="background-image: url('https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80');">
                        <div class="course-badge">Bestseller</div>
                    </div>
                    <div class="course-content">
                        <h3 class="course-title">Data Entry Mastery</h3>
                        <p class="course-duration"><i class="far fa-clock"></i> 4 weeks</p>
                        <div class="course-rating">
                            <div class="rating-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                        </div>
                        <div class="course-price">
                            <span class="current-price">$27.99</span>
                            <span class="original-price">$35.99</span>
                            <span class="bestseller">Bestseller</span>
                        </div>
                    </div>
                </div>
                
                <div class="course-card" data-course="personal-branding">
                    <div class="course-image" style="background-image: url('https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80');">
                        <div class="course-badge">Popular</div>
                    </div>
                    <div class="course-content">
                        <h3 class="course-title">Personal Branding</h3>
                        <p class="course-duration"><i class="far fa-clock"></i> 4 weeks</p>
                        <div class="course-rating">
                            <div class="rating-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="far fa-star"></i>
                            </div>
                        </div>
                        <div class="course-price">
                            <span class="current-price">$27.99</span>
                            <span class="original-price">$39.99</span>
                        </div>
                    </div>
                </div>
                
                <div class="course-card" data-course="personal-finance">
                    <div class="course-image" style="background-image: url('https://images.unsplash.com/photo-1554224155-6726b3ff858f?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80');">
                        <div class="course-badge">New</div>
                    </div>
                    <div class="course-content">
                        <h3 class="course-title">Personal Finance Management</h3>
                        <p class="course-duration"><i class="far fa-clock"></i> 6 weeks</p>
                        <div class="course-rating">
                            <div class="rating-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                        </div>
                        <div class="course-price">
                            <span class="current-price">$69.99</span>
                            <span class="original-price">$99.99</span>
                        </div>
                    </div>
                </div>
                
                <div class="course-card" data-course="graphic-design">
                    <div class="course-image" style="background-image: url('https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80');">
                        <div class="course-badge">Bestseller</div>
                    </div>
                    <div class="course-content">
                        <h3 class="course-title">Graphic Design Mastery</h3>
                        <p class="course-duration"><i class="far fa-clock"></i> 8 weeks</p>
                        <div class="course-rating">
                            <div class="rating-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                        </div>
                        <div class="course-price">
                            <span class="current-price">$35.99</span>
                            <span class="original-price">$79.99</span>
                            <span class="bestseller">Bestseller</span>
                        </div>
                    </div>
                </div>
                
                <div class="course-card" data-course="culinary">
                    <div class="course-image" style="background-image: url('https://i.postimg.cc/LXkHdmcc/20251118-1547-3D-Premium-Logo-remix-01kabfz9t4f86a77h82n4ydcdw(1).png');">
                        <div class="course-badge">Popular</div>
                    </div>
                    <div class="course-content">
                        <h3 class="course-title">Online Working Mastery</h3>
                        <p class="course-duration"><i class="far fa-clock"></i> 6 weeks</p>
                        <div class="course-rating">
                            <div class="rating-stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="far fa-star"></i>
                            </div>
                        </div>
                        <div class="course-price">
                            <span class="current-price">$21.99</span>
                            <span class="original-price">$35.99</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Why Choose Us -->
    <section class="why-choose">
        <h2 class="section-title">Why Choose Hekima Hub?</h2>
        <div class="features-grid">
            <div class="video-feature">
                <div class="video-container">
                    <iframe src="https://docs.google.com/videos/d/1jXaZrk3ZXlm5q6UThwqXF3jMvA9MYE0HMmOC5qhiOmg/edit?usp=sharing" 
                            allow="autoplay; encrypted-media" allowfullscreen></iframe>
                </div>
                <h3 style="margin-top: 1.5rem;">See What Our Students Say</h3>
                <p>Watch this video to hear from our successful students and see how Hekima Hub has transformed their learning journey.</p>
            </div>
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-play-circle"></i>
                </div>
                <h3>100+ Online Courses</h3>
                <p>Explore a variety of topics and learn at your own pace with our extensive library</p>
            </div>
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-infinity"></i>
                </div>
                <h3>Lifetime Access</h3>
                <p>Learn on your schedule with lifetime access to all your purchased courses</p>
            </div>
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <h3>Expert Instructors</h3>
                <p>Learn from industry experts who are passionate about sharing their knowledge</p>
            </div>
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h3>Learn Anywhere</h3>
                <p>Access courses on your computer, tablet, or mobile device anytime, anywhere</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-col">
                <div class="footer-logo">Hekima Hub</div>
                <p>Wisdom for the curious mind. Expand your knowledge with courses from industry experts.</p>
            </div>
            <div class="footer-links">
                <h4>Hekima Hub</h4>
                <ul>
                    <li><a href="#">About</a></li>
                    <li><a href="#">Careers</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Affiliate Program</a></li>
                </ul>
            </div>
            <div class="footer-links">
                <h4>Categories</h4>
                <ul>
                    <li><a href="#">Technology</a></li>
                    <li><a href="#">Business</a></li>
                    <li><a href="#">Design</a></li>
                    <li><a href="#">Marketing</a></li>
                </ul>
            </div>
            <div class="footer-links">
                <h4>Support</h4>
                <ul>
                    <li><a href="#">Contact Us</a></li>
                    <li><a href="#">Terms</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Help Center</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2025 Hekima Hub. All rights reserved.</p>
        </div>
    </footer>

    <!-- Course Detail Modal -->
    <div class="course-modal" id="course-modal">
        <div class="course-detail">
            <span class="close-course" id="close-course">&times;</span>
            <div class="course-detail-header" id="course-detail-header">
                <!-- Course image will be set via JS -->
            </div>
            <div class="course-detail-content">
                <h2 class="course-detail-title" id="course-detail-title">Course Title</h2>
                <div class="course-detail-meta">
                    <div class="meta-item">
                        <i class="far fa-clock"></i>
                        <span id="course-detail-duration">Duration</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-star"></i>
                        <span id="course-detail-rating">Rating</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-users"></i>
                        <span id="course-detail-students">Students</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-signal"></i>
                        <span id="course-detail-level">Level</span>
                    </div>
                </div>
                <div class="course-detail-description" id="course-detail-description">
                    <!-- Course description will be set via JS -->
                </div>
                <div class="course-detail-objectives">
                    <h3>What You'll Learn</h3>
                    <ul id="course-detail-objectives">
                        <!-- Course objectives will be set via JS -->
                    </ul>
                </div>
                <div class="course-detail-actions">
                    <div>
                        <span class="course-detail-price" id="course-detail-price">$0.00</span>
                        <span class="original-price" id="course-detail-original-price">$0.00</span>
                    </div>
                    <button class="btn btn-primary" id="add-to-cart-btn">Add to Cart</button>
                    <!-- V-PAY Payment Option -->
                    <div class="vpay-payment-option" id="vpay-payment-option">
                        <div class="vpay-logo">
                            <i class="fas fa-wallet"></i>
                            <span>Pay with V-PAY</span>
                        </div>
                        <div class="vpay-features">
                            <ul>
                                <li><i class="fas fa-check"></i> Secure payment processing</li>
                                <li><i class="fas fa-check"></i> Instant email confirmation</li>
                                <li><i class="fas fa-check"></i> M-PESA integration</li>
                                <li><i class="fas fa-check"></i> Digital receipt generation</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div class="cart-modal" id="cart-modal">
        <div class="cart-content">
            <span class="close-cart" id="close-cart">&times;</span>
            <h2>Your Cart</h2>
            <div class="cart-items" id="cart-items">
                <!-- Cart items will be added here dynamically -->
            </div>
            <div class="cart-total">
                <span>Total:</span>
                <span id="cart-total">$0.00</span>
            </div>
            <div class="checkout-form" id="checkout-form">
                <!-- V-PAY Payment Option in Cart -->
                <div class="vpay-payment-option" id="vpay-cart-option">
                    <div class="vpay-logo">
                        <i class="fas fa-wallet"></i>
                        <span>Pay with V-PAY</span>
                    </div>
                    <div class="vpay-features">
                        <ul>
                            <li><i class="fas fa-check"></i> Secure payment processing</li>
                            <li><i class="fas fa-check"></i> Instant email confirmation</li>
                            <li><i class="fas fa-check"></i> M-PESA integration</li>
                            <li><i class="fas fa-check"></i> Digital receipt generation</li>
                        </ul>
                    </div>
                </div>
                <button class="btn btn-whatsapp" id="whatsapp-checkout">
                    <i class="fab fa-whatsapp"></i> Complete Order via WhatsApp
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message">Item added to cart!</span>
    </div>

    <script>
        // Enhanced V-PAY Configuration
        const VPAY_CONFIG = {
            business: {
                name: "Hekima Hub",
                email: "finance.hekimahub@gmail.com",
                sheetName: "Hekima Hub Payments",
                paymentMethods: [
                    {
                        type: 'mpesa-till',
                        name: 'Lipa Na M-PESA',
                        details: '9442155',
                        description: 'Till Number'
                    }
                ]
            },
            // Updated script URL that supports CORS
            scriptUrl: 'https://script.google.com/macros/s/AKfycbycDPMAhgMwuuchAlTMT0hGGgIMpcUejdeapcSAVk9raWITFJpLKdQaxbociiS3a16CAg/exec',
            receiptConfig: {
                sendEmail: true,
                includeCourseDetails: true,
                autoGenerateReceipt: true
            }
        };

        // V-PAY State
        let vpayCurrentStep = 1;
        let vpaySelectedMethod = '';
        let vpayCurrentAmount = 0;
        let vpayCurrentReceipt = null;
        let pendingPayments = [];

        // V-PAY DOM Elements
        const vpayModal = document.getElementById('vpay-modal');
        const vpayClose = document.getElementById('vpay-close');
        const vpayAmountStep = document.getElementById('vpay-amount-step');
        const vpayPaymentStep = document.getElementById('vpay-payment-step');
        const vpayConfirmStep = document.getElementById('vpay-confirm-step');
        const vpayLoading = document.getElementById('vpay-loading');
        const vpaySuccess = document.getElementById('vpay-success');
        const vpayError = document.getElementById('vpay-error');
        const vpayAmountInput = document.getElementById('vpay-amount');
        const vpayMethodsContainer = document.getElementById('vpay-methods-container');
        const vpaySummaryBusiness = document.getElementById('vpay-summary-business');
        const vpaySummaryAmount = document.getElementById('vpay-summary-amount');
        const vpaySummaryMethod = document.getElementById('vpay-summary-method');
        const vpayTransactionId = document.getElementById('vpay-transaction-id');
        const vpayOfflineNotice = document.getElementById('vpay-offline-notice');

        // V-PAY Receipt Elements
        const receiptId = document.getElementById('receipt-id');
        const receiptBusiness = document.getElementById('receipt-business');
        const receiptAmount = document.getElementById('receipt-amount');
        const receiptMethod = document.getElementById('receipt-method');
        const receiptDate = document.getElementById('receipt-date');
        const receiptCourses = document.getElementById('receipt-courses');

        // V-PAY Buttons
        const vpayContinueToPayment = document.getElementById('vpay-continue-to-payment');
        const vpayBackToAmount = document.getElementById('vpay-back-to-amount');
        const vpayContinueToConfirm = document.getElementById('vpay-continue-to-confirm');
        const vpayBackToPayment = document.getElementById('vpay-back-to-payment');
        const vpaySubmitPayment = document.getElementById('vpay-submit-payment');
        const vpaySuccessClose = document.getElementById('vpay-success-close');
        const vpayErrorRetry = document.getElementById('vpay-error-retry');
        const vpayErrorClose = document.getElementById('vpay-error-close');

        // V-PAY Step Indicators
        const vpayStep1 = document.getElementById('vpay-step-1');
        const vpayStep2 = document.getElementById('vpay-step-2');
        const vpayStep3 = document.getElementById('vpay-step-3');

        // V-PAY Payment Options
        const vpayPaymentOption = document.getElementById('vpay-payment-option');
        const vpayCartOption = document.getElementById('vpay-cart-option');

        // Initialize V-PAY
        function initializeVPay() {
            // Set up event listeners for V-PAY options
            vpayPaymentOption.addEventListener('click', function() {
                if (!currentUser) {
                    showToast('Please sign in to use V-PAY.');
                    authModal.style.display = 'flex';
                    return;
                }
                openVPayModal();
            });

            vpayCartOption.addEventListener('click', function() {
                if (!currentUser) {
                    showToast('Please sign in to use V-PAY.');
                    authModal.style.display = 'flex';
                    return;
                }
                if (cart.length === 0) {
                    showToast('Your cart is empty. Please add courses before paying.');
                    return;
                }
                openVPayModal();
            });

            // V-PAY Modal Controls
            vpayClose.addEventListener('click', closeVPayModal);
            vpaySuccessClose.addEventListener('click', closeVPayModal);
            vpayErrorClose.addEventListener('click', closeVPayModal);
            vpayErrorRetry.addEventListener('click', function() {
                vpayError.style.display = 'none';
                vpayConfirmStep.style.display = 'block';
            });

            // V-PAY Step Navigation
            vpayContinueToPayment.addEventListener('click', goToVPayStep2);
            vpayBackToAmount.addEventListener('click', goToVPayStep1);
            vpayContinueToConfirm.addEventListener('click', goToVPayStep3);
            vpayBackToPayment.addEventListener('click', goToVPayStep2);
            vpaySubmitPayment.addEventListener('click', processVPayPayment);

            // Close modal when clicking outside
            vpayModal.addEventListener('click', function(e) {
                if (e.target === vpayModal) {
                    closeVPayModal();
                }
            });

            // Check for pending payments on load
            checkPendingPayments();
        }

        // Open V-PAY Modal
        function openVPayModal() {
            // Calculate total amount from cart or use course price
            if (cart.length > 0) {
                vpayCurrentAmount = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            } else if (currentCourseId && courses[currentCourseId]) {
                vpayCurrentAmount = courses[currentCourseId].price;
            }
            
            // Convert USD to KES (approximate conversion)
            vpayCurrentAmount = Math.round(vpayCurrentAmount * 130); // 1 USD = 130 KES
            
            vpayAmountInput.value = vpayCurrentAmount;
            vpayModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            resetVPayFlow();
        }

        // Close V-PAY Modal
        function closeVPayModal() {
            vpayModal.style.display = 'none';
            document.body.style.overflow = 'auto';
            resetVPayFlow();
        }

        // Reset V-PAY flow
        function resetVPayFlow() {
            vpayCurrentStep = 1;
            vpaySelectedMethod = '';
            vpayTransactionId.value = '';
            vpayCurrentReceipt = null;
            updateVPaySteps();
        }

        // Update V-PAY steps
        function updateVPaySteps() {
            // Hide all steps
            vpayAmountStep.style.display = 'none';
            vpayPaymentStep.style.display = 'none';
            vpayConfirmStep.style.display = 'none';
            vpayLoading.style.display = 'none';
            vpaySuccess.style.display = 'none';
            vpayError.style.display = 'none';

            // Show current step
            if (vpayCurrentStep === 1) {
                vpayAmountStep.style.display = 'block';
            } else if (vpayCurrentStep === 2) {
                vpayPaymentStep.style.display = 'block';
                loadVPayPaymentMethods();
            } else if (vpayCurrentStep === 3) {
                vpayConfirmStep.style.display = 'block';
                updateVPaySummary();
            }

            // Update step indicators
            vpayStep1.className = 'vpay-step-indicator';
            vpayStep2.className = 'vpay-step-indicator';
            vpayStep3.className = 'vpay-step-indicator';

            if (vpayCurrentStep >= 1) vpayStep1.classList.add('active');
            if (vpayCurrentStep >= 2) vpayStep2.classList.add('active');
            if (vpayCurrentStep >= 3) vpayStep3.classList.add('active');

            if (vpayCurrentStep > 1) vpayStep1.classList.add('completed');
            if (vpayCurrentStep > 2) vpayStep2.classList.add('completed');
        }

        // V-PAY Step Navigation
        function goToVPayStep1() {
            vpayCurrentStep = 1;
            updateVPaySteps();
        }

        function goToVPayStep2() {
            if (vpayCurrentAmount < 1) {
                showToast('Please enter a valid amount');
                return;
            }
            vpayCurrentStep = 2;
            updateVPaySteps();
        }

        function goToVPayStep3() {
            if (!vpaySelectedMethod) {
                showToast('Please select a payment method');
                return;
            }
            vpayCurrentStep = 3;
            updateVPaySteps();
        }

        // Load V-PAY payment methods
        function loadVPayPaymentMethods() {
            vpayMethodsContainer.innerHTML = '';
            
            VPAY_CONFIG.business.paymentMethods.forEach((method, index) => {
                const isActive = index === 0 && !vpaySelectedMethod;
                if (isActive) vpaySelectedMethod = method.type;
                
                const methodCard = document.createElement('div');
                methodCard.className = `vpay-method-card ${vpaySelectedMethod === method.type ? 'active' : ''}`;
                methodCard.innerHTML = `
                    <div class="vpay-method-header">
                        <div class="vpay-method-icon">
                            <i class="${getVPayMethodIcon(method.type)}"></i>
                        </div>
                        <div class="vpay-method-name">${method.name}</div>
                    </div>
                    <div class="vpay-details-card">
                        <div class="vpay-details-text">${method.description}: ${method.details}</div>
                        <button class="vpay-copy-btn" onclick="copyToClipboard('${method.details}')">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                `;
                
                methodCard.addEventListener('click', function() {
                    vpaySelectedMethod = method.type;
                    document.querySelectorAll('.vpay-method-card').forEach(card => {
                        card.classList.remove('active');
                    });
                    this.classList.add('active');
                });
                
                vpayMethodsContainer.appendChild(methodCard);
            });
        }

        // Get V-PAY method icon
        function getVPayMethodIcon(methodType) {
            const icons = {
                'mpesa-till': 'fas fa-store',
                'mpesa-send': 'fas fa-paper-plane',
                'airtel': 'fas fa-bolt',
                'paypal': 'fab fa-paypal'
            };
            return icons[methodType] || 'fas fa-money-bill-wave';
        }

        // Update V-PAY summary
        function updateVPaySummary() {
            vpaySummaryBusiness.textContent = VPAY_CONFIG.business.name;
            vpaySummaryAmount.textContent = `KES ${vpayCurrentAmount}`;
            
            const method = VPAY_CONFIG.business.paymentMethods.find(m => m.type === vpaySelectedMethod);
            vpaySummaryMethod.textContent = method ? method.name : vpaySelectedMethod;
        }

        // Copy to clipboard
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                showToast('Copied to clipboard!');
            }).catch(function() {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showToast('Copied to clipboard!');
            });
        }

        // Enhanced Process V-PAY Payment with proper Google Sheets integration
        async function processVPayPayment() {
            const transactionId = vpayTransactionId.value.trim();
            
            if (!transactionId) {
                showToast('Please enter your transaction reference number');
                return;
            }

            // Show loading
            vpayConfirmStep.style.display = 'none';
            vpayLoading.style.display = 'block';

            // Generate unique receipt ID
            const receiptId = 'HH-' + Date.now() + '-' + Math.random().toString(36).substr(2, 6).toUpperCase();
            
            // Get course details for receipt
            const courseDetails = getCourseDetailsForReceipt();
            
            const formData = {
                timestamp: new Date().toLocaleString('en-KE'),
                customerName: currentUser.name,
                customerEmail: currentUser.email,
                paymentDestination: VPAY_CONFIG.business.name,
                businessEmail: VPAY_CONFIG.business.email,
                sheetName: VPAY_CONFIG.business.sheetName,
                paymentCategory: 'course_purchase',
                amount: vpayCurrentAmount,
                paymentMethod: getVPayMethodName(vpaySelectedMethod),
                transactionId: transactionId,
                notes: `Courses: ${courseDetails.names}`,
                status: 'pending_verification',
                userId: currentUser.id,
                receiptId: receiptId,
                courseDetails: courseDetails.details,
                totalCourses: courseDetails.count,
                receiptConfig: VPAY_CONFIG.receiptConfig
            };

            try {
                console.log(' Sending payment data to Google Apps Script...');
                
                // Use fetch with proper error handling
                const response = await fetch(VPAY_CONFIG.scriptUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                console.log(' Payment processed successfully:', result);
                
                if (result.success) {
                    // Payment successfully recorded in Google Sheets
                    saveVPayTransaction(formData, false); // Not offline
                    generateReceipt(formData, courseDetails);
                    
                    // Show success
                    vpayLoading.style.display = 'none';
                    vpaySuccess.style.display = 'block';
                    
                    // Clear cart if payment was for cart items
                    if (cart.length > 0) {
                        cart = [];
                        updateCart();
                    }
                    
                    showToast('Payment submitted successfully! Receipt sent to your email.');
                } else {
                    throw new Error(result.message || 'Payment processing failed');
                }
                
            } catch (error) {
                console.error(' Error processing payment:', error);
                
                // Check if we're offline
                if (!navigator.onLine) {
                    // Save as pending payment for when we're back online
                    savePendingPayment(formData);
                    saveVPayTransaction(formData, true); // Mark as offline
                    generateReceipt(formData, courseDetails);
                    
                    // Show success with offline notice
                    vpayLoading.style.display = 'none';
                    vpaySuccess.style.display = 'block';
                    document.getElementById('vpay-success-message').textContent = 
                        'Payment saved offline. It will be processed when you are back online.';
                    
                    showToast('Payment saved offline. Will process when online.', 'warning');
                } else {
                    // Show error for online failures
                    vpayLoading.style.display = 'none';
                    vpayError.style.display = 'block';
                    document.getElementById('vpay-error-message').textContent = 
                        'There was an error processing your payment. Please try again.';
                    
                    showToast('Payment processing failed. Please try again.', 'error');
                }
            }
        }

        // Save pending payment for retry
        function savePendingPayment(formData) {
            const pendingKey = `vpay_pending_${currentUser.id}`;
            let pending = JSON.parse(localStorage.getItem(pendingKey) || '[]');
            pending.push({
                ...formData,
                retryCount: 0,
                lastRetry: new Date().toISOString()
            });
            localStorage.setItem(pendingKey, JSON.stringify(pending));
        }

        // Check and retry pending payments
        async function checkPendingPayments() {
            if (!currentUser || !navigator.onLine) return;
            
            const pendingKey = `vpay_pending_${currentUser.id}`;
            let pending = JSON.parse(localStorage.getItem(pendingKey) || '[]');
            
            if (pending.length === 0) return;
            
            console.log(` Processing ${pending.length} pending payments...`);
            
            const successfulPayments = [];
            
            for (const payment of pending) {
                try {
                    const response = await fetch(VPAY_CONFIG.scriptUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(payment)
                    });

                    if (response.ok) {
                        const result = await response.json();
                        if (result.success) {
                            successfulPayments.push(payment);
                            console.log(` Processed pending payment: ${payment.receiptId}`);
                        }
                    }
                } catch (error) {
                    console.error(` Failed to process pending payment: ${payment.receiptId}`, error);
                }
            }
            
            // Remove successful payments from pending list
            if (successfulPayments.length > 0) {
                pending = pending.filter(p => !successfulPayments.some(sp => sp.receiptId === p.receiptId));
                localStorage.setItem(pendingKey, JSON.stringify(pending));
                console.log(` Completed processing ${successfulPayments.length} pending payments`);
            }
        }

        // Generate receipt details
        function generateReceipt(formData, courseDetails) {
            // Update receipt elements
            document.getElementById('receipt-id').textContent = formData.receiptId;
            document.getElementById('receipt-business').textContent = formData.paymentDestination;
            document.getElementById('receipt-amount').textContent = `KES ${formData.amount}`;
            document.getElementById('receipt-method').textContent = formData.paymentMethod;
            document.getElementById('receipt-date').textContent = formData.timestamp;
            document.getElementById('receipt-courses').textContent = courseDetails.names;
            
            // Store receipt for potential download/email
            vpayCurrentReceipt = {
                id: formData.receiptId,
                business: formData.paymentDestination,
                amount: formData.amount,
                method: formData.paymentMethod,
                date: formData.timestamp,
                courses: courseDetails.names,
                customer: currentUser.name,
                email: currentUser.email
            };
        }

        // Get course details for receipt
        function getCourseDetailsForReceipt() {
            if (cart.length > 0) {
                const names = cart.map(item => item.title).join(', ');
                const details = cart.map(item => ({
                    title: item.title,
                    price: item.price,
                    quantity: item.quantity,
                    total: item.price * item.quantity
                }));
                return {
                    names: names,
                    details: details,
                    count: cart.length
                };
            } else if (currentCourseId && courses[currentCourseId]) {
                return {
                    names: courses[currentCourseId].title,
                    details: [{
                        title: courses[currentCourseId].title,
                        price: courses[currentCourseId].price,
                        quantity: 1,
                        total: courses[currentCourseId].price
                    }],
                    count: 1
                };
            }
            return {
                names: 'Course Purchase',
                details: [],
                count: 0
            };
        }

        // Get V-PAY method name
        function getVPayMethodName(methodType) {
            const method = VPAY_CONFIG.business.paymentMethods.find(m => m.type === methodType);
            return method ? method.name : methodType;
        }

        // Save V-PAY transaction
        function saveVPayTransaction(formData, isOffline = false) {
            const userTransactionsKey = `vpay_transactions_${currentUser.id}`;
            let payments = JSON.parse(localStorage.getItem(userTransactionsKey) || '[]');
            
            const paymentRecord = {
                ...formData,
                offline: isOffline,
                processed: !isOffline,
                timestamp: new Date().toISOString(),
                id: Date.now().toString()
            };
            
            payments.push(paymentRecord);
            localStorage.setItem(userTransactionsKey, JSON.stringify(payments));
            
            console.log(' V-PAY payment saved to localStorage:', paymentRecord);
        }

        // Replace with your actual Google Client ID
        const GOOGLE_CLIENT_ID = '230366555128-bkm4jhc3c14scafm8808uk8u456u6cfk.apps.googleusercontent.com';

        // Course data with detailed information
        const courses = {
            'data-entry': {
                title: 'Data Entry Mastery',
                price: 27.99,
                originalPrice: 79.99,
                duration: '4 weeks',
                students: '12,500+ students',
                level: 'Beginner',
                image: 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80',
                description: 'Master the art of accurate and efficient data entry with this comprehensive course. Learn essential skills for data management, keyboard shortcuts, and productivity techniques that will make you a valuable asset in any organization.',
                objectives: [
                    'Understand data entry fundamentals and best practices',
                    'Master keyboard shortcuts for increased productivity',
                    'Learn data validation and error checking techniques',
                    'Develop skills in spreadsheet software like Excel',
                    'Improve typing speed and accuracy',
                    'Understand data security and confidentiality'
                ]
            },
            'personal-branding': {
                title: 'Personal Branding',
                price: 27.99,
                originalPrice: 89.99,
                duration: '4 weeks',
                students: '8,200+ students',
                level: 'All Levels',
                image: 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80',
                description: 'Build a powerful personal brand that sets you apart in your career or business. Learn how to communicate your unique value proposition and create a lasting impression.',
                objectives: [
                    'Define your personal brand identity',
                    'Create a compelling personal brand statement',
                    'Develop a consistent online presence',
                    'Build a professional network',
                    'Leverage social media for personal branding',
                    'Create a personal branding action plan'
                ]
            },
            'personal-finance': {
                title: 'Personal Finance Management',
                price: 69.99,
                originalPrice: 99.99,
                duration: '6 weeks',
                students: '15,800+ students',
                level: 'Beginner',
                image: 'https://images.unsplash.com/photo-1554224155-6726b3ff858f?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80',
                description: 'Take control of your financial future with this comprehensive personal finance course. Learn budgeting, investing, debt management, and wealth-building strategies.',
                objectives: [
                    'Create and maintain a personal budget',
                    'Understand different investment options',
                    'Develop a debt repayment strategy',
                    'Plan for retirement and financial independence',
                    'Learn tax optimization strategies',
                    'Build an emergency fund and insurance portfolio'
                ]
            },
            'graphic-design': {
                title: 'Graphic Design and Graphic Arts',
                price: 35.99,
                originalPrice: 119.99,
                duration: '8 weeks',
                students: '22,100+ students',
                level: 'Beginner to Intermediate',
                image: 'https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80',
                description: 'Unleash your creativity with this comprehensive graphic design course. Learn design principles, color theory, typography, and how to use industry-standard tools.',
                objectives: [
                    'Master design principles and composition',
                    'Understand color theory and psychology',
                    'Learn typography fundamentals',
                    'Create logos, brochures, and digital graphics',
                    'Develop skills in Adobe Creative Suite',
                    'Build a professional design portfolio'
                ]
            },
            'culinary': {
                title: 'Online Working Mastery',
                price: 21.99,
                originalPrice: 109.99,
                duration: '6 weeks',
                students: '9,500+ students',
                level: 'Beginner',
                image: 'https://i.postimg.cc/LXkHdmcc/20251118-1547-3D-Premium-Logo-remix-01kabfz9t4f86a77h82n4ydcdw(1).png',
                description: 'Discover the skills that make you an efficient online working specialist',
                objectives: [
                    'Master basic knife skills and kitchen safety',
                    'Understand cooking methods and techniques',
                    'Learn flavor profiles and ingredient pairing',
                    'Create balanced and nutritious meals',
                    'Develop plating and presentation skills',
                    'Plan and execute complete menus'
                ]
            }
        };

        // All available courses for search
        const allCourses = [
            'Data Entry Mastery',
            'Personal Branding',
            'Personal Finance Management',
            'Graphic Design and Graphic Arts',
            'Introduction to Culinary Mastery',
            'Web Development Bootcamp',
            'Digital Marketing Strategy',
            'Python Programming',
            'Data Science Fundamentals',
            'Mobile App Development',
            'UI/UX Design Principles',
            'Project Management',
            'Business Analytics',
            'Content Writing Mastery',
            'Social Media Marketing'
        ];

        // Cart functionality
        let cart = [];
        let currentUser = null;
        let googleInitialized = false;

        // DOM Elements
        const cartModal = document.getElementById('cart-modal');
        const cartIcon = document.getElementById('cart-icon');
        const cartCount = document.getElementById('cart-count');
        const closeCart = document.getElementById('close-cart');
        const cartItems = document.getElementById('cart-items');
        const cartTotal = document.getElementById('cart-total');
        const checkoutBtn = document.getElementById('checkout-btn');
        const checkoutForm = document.getElementById('checkout-form');
        const whatsappCheckout = document.getElementById('whatsapp-checkout');

        // Course modal elements
        const courseModal = document.getElementById('course-modal');
        const closeCourse = document.getElementById('close-course');
        const courseDetailHeader = document.getElementById('course-detail-header');
        const courseDetailTitle = document.getElementById('course-detail-title');
        const courseDetailDuration = document.getElementById('course-detail-duration');
        const courseDetailRating = document.getElementById('course-detail-rating');
        const courseDetailStudents = document.getElementById('course-detail-students');
        const courseDetailLevel = document.getElementById('course-detail-level');
        const courseDetailDescription = document.getElementById('course-detail-description');
        const courseDetailObjectives = document.getElementById('course-detail-objectives');
        const courseDetailPrice = document.getElementById('course-detail-price');
        const courseDetailOriginalPrice = document.getElementById('course-detail-original-price');
        const addToCartBtn = document.getElementById('add-to-cart-btn');

        // Search elements
        const searchInput = document.getElementById('search-input');
        const heroSearchInput = document.getElementById('hero-search-input');
        const searchButton = document.getElementById('search-button');
        const searchSuggestions = document.getElementById('search-suggestions');

        // Mobile menu elements
        const menuToggle = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        const closeMenu = document.getElementById('close-menu');

        // Auth elements
        const authModal = document.getElementById('auth-modal');
        const signinBtn = document.getElementById('signin-btn');
        const authButtons = document.getElementById('auth-buttons');
        const userMenu = document.getElementById('user-menu');
        const userAvatar = document.getElementById('user-avatar');
        const userDropdown = document.getElementById('user-dropdown');
        const userDropdownName = document.getElementById('user-dropdown-name');
        const userDropdownEmail = document.getElementById('user-dropdown-email');
        const logoutBtn = document.getElementById('logout-btn');
        const googleSigninBtn = document.getElementById('google-signin-btn');
        const googleBtnText = document.getElementById('google-btn-text');
        const mobileSignin = document.getElementById('mobile-signin');

        // Toast notification
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');

        // Current course being viewed
        let currentCourseId = null;

        // Initialize Google Sign-In with better error handling
        function initializeGoogleSignIn() {
            if (typeof google === 'undefined') {
                console.warn('Google Identity Services not loaded yet, retrying...');
                setTimeout(initializeGoogleSignIn, 500);
                return;
            }

            try {
                google.accounts.id.initialize({
                    client_id: GOOGLE_CLIENT_ID,
                    callback: handleGoogleSignIn,
                    error_callback: handleGoogleSignInError,
                    ux_mode: 'popup',
                    auto_select: false
                });

                // Render Google Sign-In button
                google.accounts.id.renderButton(
                    document.getElementById('google-signin-container'),
                    { 
                        theme: "outline", 
                        size: "large", 
                        width: "100%",
                        text: "continue_with",
                        shape: "rectangular"
                    }
                );

                googleInitialized = true;
                console.log('Google Sign-In initialized successfully');

            } catch (error) {
                console.error('Error initializing Google Sign-In:', error);
                setupFallbackGoogleButton();
            }
        }

        // Fallback Google button if initialization fails
        function setupFallbackGoogleButton() {
            googleSigninBtn.innerHTML = '<i class="fab fa-google"></i> Continue with Google';
            googleSigninBtn.onclick = () => {
                showToast('Google Sign-In is temporarily unavailable. Please try again later.');
            };
            googleSigninBtn.style.opacity = '0.7';
        }

        // Handle Google Sign-In
        function handleGoogleSignIn(response) {
            console.log('Google Sign-In response received');
            
            try {
                const userInfo = parseJwt(response.credential);
                
                if (!userInfo) {
                    throw new Error('Invalid token response');
                }
                
                currentUser = {
                    id: userInfo.sub,
                    name: userInfo.name,
                    email: userInfo.email,
                    picture: userInfo.picture,
                    provider: 'google'
                };

                updateUserInterface();
                authModal.style.display = 'none';
                showToast(`Welcome to Hekima Hub, ${userInfo.name}!`);
                
                // Save to localStorage
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                console.log('User signed in successfully:', currentUser);
                
            } catch (error) {
                console.error('Error handling Google Sign-In:', error);
                showToast('Error signing in. Please try again.', 'error');
            }
        }

        function handleGoogleSignInError(error) {
            console.error('Google Sign-In error:', error);
            showToast('Error with Google Sign-In. Please try again.', 'error');
        }

        // Parse JWT token
        function parseJwt(token) {
            try {
                const base64Url = token.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));

                return JSON.parse(jsonPayload);
            } catch (e) {
                console.error('Error parsing JWT:', e);
                return null;
            }
        }

        // Update UI based on user authentication state
        function updateUserInterface() {
            if (currentUser) {
                // User is logged in
                authButtons.style.display = 'none';
                userMenu.style.display = 'flex';
                
                // Set user info
                userAvatar.src = currentUser.picture;
                userDropdownName.textContent = currentUser.name;
                userDropdownEmail.textContent = currentUser.email;
            } else {
                // User is logged out
                authButtons.style.display = 'flex';
                userMenu.style.display = 'none';
            }
        }

        // Auth modal functionality
        signinBtn.addEventListener('click', () => {
            authModal.style.display = 'flex';
            // Re-initialize Google Sign-In when modal opens
            if (!googleInitialized) {
                setTimeout(initializeGoogleSignIn, 100);
            }
        });

        mobileSignin.addEventListener('click', (e) => {
            e.preventDefault();
            mobileMenu.classList.remove('active');
            authModal.style.display = 'flex';
            // Re-initialize Google Sign-In when modal opens
            if (!googleInitialized) {
                setTimeout(initializeGoogleSignIn, 100);
            }
        });

        // Close auth modal when clicking outside
        authModal.addEventListener('click', (e) => {
            if (e.target === authModal) {
                authModal.style.display = 'none';
            }
        });

        // User dropdown functionality
        userAvatar.addEventListener('click', () => {
            userDropdown.classList.toggle('active');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!userMenu.contains(e.target)) {
                userDropdown.classList.remove('active');
            }
        });

        // Logout functionality
        logoutBtn.addEventListener('click', () => {
            currentUser = null;
            updateUserInterface();
            showToast('You have been logged out successfully.');
            
            // Remove from localStorage
            localStorage.removeItem('currentUser');
            
            // Google Sign-Out
            if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                google.accounts.id.disableAutoSelect();
                google.accounts.id.revoke(localStorage.getItem('currentUser')?.email, () => {
                    console.log('Google Sign-Out completed');
                });
            }
        });

        // Show course details when clicking on a course card
        document.querySelectorAll('.course-card').forEach(card => {
            card.addEventListener('click', function() {
                const courseId = this.getAttribute('data-course');
                currentCourseId = courseId;
                showCourseDetails(courseId);
            });
        });

        // Show course details in modal
        function showCourseDetails(courseId) {
            const course = courses[courseId];
            
            courseDetailHeader.style.backgroundImage = `url('${course.image}')`;
            courseDetailTitle.textContent = course.title;
            courseDetailDuration.textContent = course.duration;
            courseDetailRating.textContent = course.rating;
            courseDetailStudents.textContent = course.students;
            courseDetailLevel.textContent = course.level;
            courseDetailDescription.textContent = course.description;
            
            // Clear and populate objectives
            courseDetailObjectives.innerHTML = '';
            course.objectives.forEach(objective => {
                const li = document.createElement('li');
                li.textContent = objective;
                courseDetailObjectives.appendChild(li);
            });
            
            courseDetailPrice.textContent = `$${course.price}`;
            courseDetailOriginalPrice.textContent = `$${course.originalPrice}`;
            
            // Show the modal
            courseModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        // Add to cart from course modal
        addToCartBtn.addEventListener('click', function() {
            if (!currentUser) {
                showToast('Please sign in to add courses to your cart.');
                authModal.style.display = 'flex';
                return;
            }
            
            if (currentCourseId) {
                addToCart(currentCourseId);
            }
        });

        // Add to cart functionality
        function addToCart(courseId) {
            const course = courses[courseId];
            
            // Check if course is already in cart
            const existingItem = cart.find(item => item.id === courseId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: courseId,
                    title: course.title,
                    price: course.price,
                    quantity: 1
                });
            }
            
            updateCart();
            showToast(`${course.title} has been added to your cart!`);
            courseModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Update cart display
        function updateCart() {
            cartItems.innerHTML = '';
            let total = 0;
            let itemCount = 0;
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p>Your cart is empty</p>';
            } else {
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    itemCount += item.quantity;
                    
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    cartItem.innerHTML = `
                        <div class="cart-item-info">
                            <h4>${item.title}</h4>
                            <p>$${item.price} x ${item.quantity}</p>
                        </div>
                        <div class="cart-item-price">$${itemTotal.toFixed(2)}</div>
                        <button class="remove-item" data-id="${item.id}">&times;</button>
                    `;
                    cartItems.appendChild(cartItem);
                });
                
                // Add event listeners to remove buttons
                document.querySelectorAll('.remove-item').forEach(button => {
                    button.addEventListener('click', function() {
                        const itemId = this.getAttribute('data-id');
                        cart = cart.filter(item => item.id !== itemId);
                        updateCart();
                    });
                });
            }
            
            cartTotal.textContent = `$${total.toFixed(2)}`;
            cartCount.textContent = itemCount;
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            toastMessage.textContent = message;
            toast.className = 'toast';
            
            if (type === 'success') {
                toast.classList.add('show', 'toast-success');
            } else if (type === 'error') {
                toast.classList.add('show', 'toast-error');
            } else if (type === 'warning') {
                toast.classList.add('show', 'toast-warning');
            }
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Cart modal controls
        cartIcon.addEventListener('click', function(e) {
            e.preventDefault();
            if (!currentUser) {
                showToast('Please sign in to view your cart.');
                authModal.style.display = 'flex';
                return;
            }
            cartModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        });

        closeCart.addEventListener('click', function() {
            cartModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        });

        closeCourse.addEventListener('click', function() {
            courseModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        });

        window.addEventListener('click', function(e) {
            if (e.target === cartModal) {
                cartModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
            if (e.target === courseModal) {
                courseModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });

        // WhatsApp checkout
        whatsappCheckout.addEventListener('click', function() {
            if (!currentUser) {
                showToast('Please sign in to complete your purchase.');
                authModal.style.display = 'flex';
                return;
            }
            
            if (cart.length === 0) {
                showToast('Your cart is empty. Please add courses before checking out.');
                return;
            }
            
            // Format cart items for message
            let cartSummary = 'Order Summary:%0A';
            let total = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                cartSummary += `- ${item.title} (Qty: ${item.quantity}) - $${itemTotal.toFixed(2)}%0A`;
            });
            
            cartSummary += `%0ATotal: $${total.toFixed(2)}`;
            
            // Create WhatsApp message with user info
            const message = `Hello! I would like to purchase the following courses from Hekima Hub:%0A%0A${cartSummary}%0A%0ACustomer Details:%0AName: ${currentUser.name}%0AEmail: ${currentUser.email}`;
            
            // Open WhatsApp with pre-filled message
            window.open(`https://wa.me/254784599322?text=${message}`, '_blank');
            
            // Reset cart and close modal
            cart = [];
            updateCart();
            cartModal.style.display = 'none';
            document.body.style.overflow = 'auto';
            
            showToast('Order completed successfully! Check WhatsApp to finalize your purchase.');
        });

        // Search functionality with autocomplete
        function setupSearchInput(inputElement) {
            inputElement.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                searchSuggestions.innerHTML = '';
                
                if (searchTerm.length > 0) {
                    const filteredCourses = allCourses.filter(course => 
                        course.toLowerCase().includes(searchTerm)
                    );
                    
                    if (filteredCourses.length > 0) {
                        searchSuggestions.style.display = 'block';
                        
                        filteredCourses.forEach(course => {
                            const suggestion = document.createElement('div');
                            suggestion.className = 'search-suggestion';
                            suggestion.textContent = course;
                            suggestion.addEventListener('click', function() {
                                inputElement.value = course;
                                searchSuggestions.style.display = 'none';
                                performSearch(course);
                            });
                            searchSuggestions.appendChild(suggestion);
                        });
                    } else {
                        searchSuggestions.style.display = 'none';
                    }
                } else {
                    searchSuggestions.style.display = 'none';
                }
            });
            
            // Hide suggestions when clicking outside
            document.addEventListener('click', function(e) {
                if (!inputElement.contains(e.target) && !searchSuggestions.contains(e.target)) {
                    searchSuggestions.style.display = 'none';
                }
            });
        }

        // Set up both search inputs
        setupSearchInput(searchInput);
        setupSearchInput(heroSearchInput);

        // Perform search
        function performSearch(searchTerm) {
            if (searchTerm.trim() !== '') {
                // In a real implementation, this would filter courses
                showToast(`Searching for: "${searchTerm}"`);
                
                // For demo purposes, if the search matches a course, open its details
                const courseId = Object.keys(courses).find(id => 
                    courses[id].title.toLowerCase() === searchTerm.toLowerCase()
                );
                
                if (courseId) {
                    showCourseDetails(courseId);
                }
            } else {
                showToast('Please enter a search term.');
            }
        }

        // Search button click
        searchButton.addEventListener('click', function() {
            performSearch(searchInput.value);
        });

        // Enter key in search inputs
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch(this.value);
            }
        });

        heroSearchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch(this.value);
            }
        });

        // Mobile menu functionality
        menuToggle.addEventListener('click', function() {
            mobileMenu.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        closeMenu.addEventListener('click', function() {
            mobileMenu.classList.remove('active');
            document.body.style.overflow = 'auto';
        });

        // Close mobile menu when clicking on a link
        document.querySelectorAll('.mobile-nav-links a').forEach(link => {
            if (link.id !== 'mobile-signin') {
                link.addEventListener('click', function() {
                    mobileMenu.classList.remove('active');
                    document.body.style.overflow = 'auto';
                });
            }
        });

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, initializing application...');
            
            // Check if user is already logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    console.log('Found saved user:', currentUser);
                } catch (e) {
                    console.error('Error parsing saved user:', e);
                    localStorage.removeItem('currentUser');
                }
            }
            
            updateUserInterface();
            
            // Initialize Google Sign-In with delay to ensure script is loaded
            setTimeout(initializeGoogleSignIn, 1000);
            
            // Initialize cart
            updateCart();
            
            // Initialize V-PAY
            initializeVPay();

            // Listen for online/offline events
            window.addEventListener('online', function() {
                console.log('App is online, checking pending payments...');
                checkPendingPayments();
            });

            window.addEventListener('offline', function() {
                console.log('App is offline');
            });
        });

        // Additional initialization when window loads completely
        window.addEventListener('load', () => {
            console.log('Window fully loaded');
            if (!googleInitialized) {
                initializeGoogleSignIn();
            }
        });
    </script>
</body>
</html>
